const GRAPH_DATA = {
    "bindTo": "#root",
    "axis": {
        "x": {
            "type": "timeseries",
            "label": "Documented Date/Time",
            "lowerLimit": "2021-10-17T04:00:00.000Z",
            "upperLimit": "2021-10-19T02:00:00.000Z"
        },
        "y": {
            "label": "Dose Rate (mcg/min)",
            "show": true,
            "lowerLimit": 1,
            "upperLimit": 14
        },
        "y2": {
            "show": true,
            "label": "Score",
            "lowerLimit": -4,
            "upperLimit": 0
        }
    }
};

const CONTENT_DATA = [
    {
        "key": "meds",
        "label": {
            "display": "norepinephrine 8 mg"
        },
        "values": [
            {
                "x": "2021-10-17T17:00:00Z",
                "y": 5
            },
            {
                "x": "2021-10-17T21:44:00Z",
                "y": 3
            },
            {
                "x": "2021-10-18T01:35:00Z",
                "y": 1
            },
            {
                "x": "2021-10-18T02:57:00Z",
                "y": 3
            },
            {
                "x": "2021-10-18T04:00:00Z",
                "y": 2
            },
            {
                "x": "2021-10-18T06:23:00Z",
                "y": 1
            },
            {
                "x": "2021-10-18T07:08:00Z",
                "y": 2
            },
            {
                "x": "2021-10-18T07:30:00Z",
                "y": 3
            },
            {
                "x": "2021-10-18T11:30:00Z",
                "y": 5
            },
            {
                "x": "2021-10-18T12:30:00Z",
                "y": 6
            },
            {
                "x": "2021-10-18T13:00:00Z",
                "y": 8
            },
            {
                "x": "2021-10-18T13:15:00Z",
                "y": 12
            },
            {
                "x": "2021-10-18T13:45:00Z",
                "y": 14
            },
            {
                "x": "2021-10-18T18:17:00Z",
                "y": 8
            },
            {
                "x": "2021-10-18T19:00:00Z",
                "y": 6
            },
            {
                "x": "2021-10-18T21:30:00Z",
                "y": 10
            },
            {
                "x": "2021-10-18T22:00:00Z",
                "y": 8
            },
            {
                "x": "2021-10-18T22:45:00Z",
                "y": 4
            },
            {
                "x": "2021-10-19T00:15:00Z",
                "y": 2
            },
            {
                "x": "2021-10-19T01:12:00Z",
                "y": 1
            }
        ],
        "yAxis": "y"
    },
    {
        "key": "scores",
        "label": {
            "display": "Richmond Agitation Sedation Scale"
        },
        "shape": {
            "path": {
                "d": "M24 0l24 24-24 24L0 24 24 0z"
            },
            "options": {
                "x": -6.2,
                "y": -6,
                "scale": 0.25
            }
        },
        "color": "#176ba0",
        "values": [
            {
                "x": "2021-10-17T04:00:00Z",
                "y": 0
            },
            {
                "x": "2021-10-17T07:00:00Z",
                "y": -1
            },
            {
                "x": "2021-10-17T08:00:00Z",
                "y": -1
            },
            {
                "x": "2021-10-17T09:00:00Z",
                "y": -1
            },
            {
                "x": "2021-10-17T10:00:00Z",
                "y": -1
            },
            {
                "x": "2021-10-17T11:00:00Z",
                "y": -1
            },
            {
                "x": "2021-10-17T12:00:00Z",
                "y": -1
            },
            {
                "x": "2021-10-17T17:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-17T18:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-17T19:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-17T20:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-17T21:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-17T23:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T00:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T01:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T02:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T03:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T04:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T05:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T06:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T07:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T08:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T09:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T10:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T11:00:00Z",
                "y": -3
            },
            {
                "x": "2021-10-18T12:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T13:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T14:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T21:30:00Z",
                "y": -4
            },
            {
                "x": "2021-10-18T23:00:00Z",
                "y": -4
            },
            {
                "x": "2021-10-19T02:00:00Z",
                "y": -4
            }
        ],
        "yAxis": "y2"
    }
];

let canvas;
let loaded = false;

document.getElementById("reload").addEventListener("click", () => {
    canvas = canvas ? canvas.reflowMultipleDatasets(GRAPH_DATA) : Carbon.api.graph(GRAPH_DATA);

    if (loaded) {
        canvas.unloadContent(CONTENT_DATA);
    }
    else {
        loaded = true;
    }

    canvas.loadContent(CONTENT_DATA.map(data => Carbon.api.line(data)));
});
